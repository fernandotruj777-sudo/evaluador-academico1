requirements.txt
streamlit
openai
python-docx
PyPDF2
pytesseract
Pillow

import streamlit as st
from openai import OpenAI
import docx
import PyPDF2
import pytesseract
from PIL import Image

pytesseract.pytesseract.tesseract_cmd = r"C:\Program Files\Tesseract-OCR\tesseract.exe"

import os

client = OpenAI(
    api_key=os.getenv("OPENROUTER_API_KEY"),
    base_url="https://openrouter.ai/api/v1"
)
)

# ----------------------------
# FUNCIONES
# ----------------------------

def leer_docx(archivo):
    doc = docx.Document(archivo)
    texto = ""
    for parrafo in doc.paragraphs:
        texto += parrafo.text + "\n"
    return texto

def leer_pdf(archivo):
    lector = PyPDF2.PdfReader(archivo)
    texto = ""
    for pagina in lector.pages:
        if pagina.extract_text():
            texto += pagina.extract_text()
    return texto

def leer_imagen(archivo):
    imagen = Image.open(archivo)
    texto = pytesseract.image_to_string(imagen, lang='spa')
    return texto

# ----------------------------
# INTERFAZ
# ----------------------------

st.title("üìö Evaluador Acad√©mico Inteligente")

tipo_actividad = st.selectbox(
    "Tipo de actividad",
    [
        "Ensayo",
        "L√≠nea del tiempo",
        "Cuadro SQA",
        "Tabla QQQ",
        "Mapa mental",
        "Cuadro sin√≥ptico",
        "Foro"
    ]
)

rubrica_personalizada = st.text_area(
    "Pega aqu√≠ la r√∫brica oficial de la universidad",
    height=300
)

archivo = st.file_uploader(
    "Sube archivo (.docx, .pdf, imagen)",
    type=["docx", "pdf", "png", "jpg", "jpeg"]
)

if archivo is not None and rubrica_personalizada:

    if archivo.name.endswith(".docx"):
        texto = leer_docx(archivo)

    elif archivo.name.endswith(".pdf"):
        texto = leer_pdf(archivo)

    elif archivo.name.endswith(("png", "jpg", "jpeg")):
        texto = leer_imagen(archivo)

    if st.button("Evaluar Documento"):

        prompt = f"""
Eres un docente experto en evaluaci√≥n acad√©mica.

Tipo de actividad: {tipo_actividad}

Eval√∫a el siguiente trabajo usando EXACTAMENTE esta r√∫brica:

{rubrica_personalizada}

Respeta los criterios y ponderaciones indicadas.
Devuelve calificaci√≥n por criterio y promedio final.
Agrega retroalimentaci√≥n detallada.

Trabajo:
{texto}
"""

        response = client.chat.completions.create(
            model="mistralai/mistral-7b-instruct",
            messages=[{"role": "user", "content": prompt}]
        )

        st.write(response.choices[0].message.content)

elif not rubrica_personalizada:
    st.warning("Debes pegar la r√∫brica antes de evaluar.")
